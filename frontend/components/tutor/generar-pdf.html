<!-- Modal de Previsualización de Constancia de Tutoría -->
<div id="modalGenerarPDF" class="modal-overlay-pdf" style="display: none;">
    <div class="modal-content-pdf">
        <div class="modal-header-pdf">
            <h2>Previsualización - Constancia de Tutoría</h2>
            <button onclick="cerrarModalPDF()" class="modal-close-btn-pdf" title="Cerrar">×</button>
        </div>
        
        <!-- Área de notificaciones -->
        <div id="pdfNotification" class="pdf-notification" style="display:none;">
            <div class="notification-content">
                <span id="notificationIcon" class="notification-icon"></span>
                <span id="notificationMessage" class="notification-message"></span>
            </div>
        </div>
        
        <!-- Modal de confirmación interno -->
        <div id="pdfConfirmDialog" class="pdf-confirm-dialog" style="display:none;">
            <div class="confirm-content">
                <div class="confirm-icon">⚠️</div>
                <div class="confirm-message" id="confirmMessage"></div>
                <div class="confirm-buttons">
                    <button id="confirmYes" class="btn-confirm-yes">Sí, firmar</button>
                    <button id="confirmNo" class="btn-confirm-no">Cancelar</button>
                </div>
            </div>
        </div>
        
        <div class="modal-body-pdf">
            <!-- Mensaje de error -->
            <div id="pdfErrorMessage" class="pdf-error-message" style="display:none;">
                <div class="error-icon">⚠️</div>
                <div class="error-title">No se puede previsualizar el PDF</div>
                <div class="error-subtitle">Tu navegador no puede mostrar el PDF directamente.</div>
                <div class="error-buttons">
                    <button onclick="abrirPDFNuevaPestaña()" class="btn-primary-pdf">
                        Abrir en Nueva Pestaña
                    </button>
                    <button onclick="descargarPDFConstancia()" class="btn-secondary-pdf">
                        Descargar PDF
                    </button>
                </div>
            </div>
            
            <!-- Indicador de carga -->
            <div id="loadingPDFIndicator" class="pdf-loading" style="display:none;">
                <div class="spinner-pdf"></div>
                <div class="loading-text-pdf">Cargando PDF...</div>
            </div>
            
            <!-- Canvas para renderizar el PDF -->
            <div id="pdfCanvasContainer" style="width: 100%; height: 100%; overflow-y: auto; overflow-x: hidden; background: #525659; padding: 20px; display: none; -webkit-overflow-scrolling: touch;">
                <div id="pdfPagesContainer" style="display: flex; flex-direction: column; align-items: center; gap: 20px;">
                    <!-- Las páginas del PDF se renderizarán aquí -->
                </div>
            </div>
            
            <!-- Iframe para mostrar el PDF (fallback) -->
            <iframe id="iframeConstanciaPDF" class="iframe-pdf" style="display: none;"></iframe>
        </div>
        
        <div class="modal-footer-pdf">
            <button id="btnFirmarConstancia" onclick="firmarConstanciaModal()" class="btn-footer-pdf btn-success-pdf">
                Firmar Constancia
            </button>
            <button id="btnGuardarConstancia" onclick="guardarConstanciaModal()" class="btn-footer-pdf btn-primary-pdf">
                Guardar
            </button>
            <button onclick="descargarPDFConstancia()" class="btn-footer-pdf btn-secondary-pdf">
                Descargar PDF
            </button>
            <button onclick="cerrarModalPDF()" class="btn-footer-pdf btn-tertiary-pdf">
                Cerrar
            </button>
        </div>
    </div>
</div>
